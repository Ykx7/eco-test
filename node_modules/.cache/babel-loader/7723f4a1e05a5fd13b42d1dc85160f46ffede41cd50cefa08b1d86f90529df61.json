{"ast":null,"code":"import{useEffect,useState}from\"react\";import axios from\"axios\";import\"./DashProducts.css\";// Add this line\nimport{Link,useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function ShowProducts(){const[products,setProducts]=useState([]);const BASE_URL=\"http://127.0.0.1:8000\";const nav=useNavigate();// Move fetchProducts outside so we can use it after deletion too\nconst fetchProducts=async()=>{try{const res=await axios.get(\"http://127.0.0.1:8000/api/product/show\");setProducts(res.data);console.log(res.data);}catch(err){console.error(\"Failed to fetch products:\",err);}};useEffect(()=>{fetchProducts();},[]);console.log(\"Products:\",products);function handleDelete(id){axios.delete(\"http://127.0.0.1:8000/api/product/delete/\".concat(id)).then(()=>{console.log(\"Deleted product\",id);// You can refetch or filter it out from the list\nfetchProducts();// ⬅️ Call this to refresh the list\n}).catch(err=>{console.error(\"Error deleting product:\",err);},[]);}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"page-title\",children:\"Products\"}),/*#__PURE__*/_jsx(\"div\",{className:\"product-grid\",children:products.map(product=>{var _product$images;return/*#__PURE__*/_jsxs(\"div\",{className:\"product-card\",children:[/*#__PURE__*/_jsx(\"img\",{src:((_product$images=product.images)===null||_product$images===void 0?void 0:_product$images.length)>0?BASE_URL+product.images[0]:product.image?BASE_URL+product.image:\"/default.jpg\"// fallback if no image at all\n,alt:product.title,className:\"product-image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-info\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"product-title\",children:product.title}),/*#__PURE__*/_jsx(\"p\",{className:\"product-desc\",children:product.description}),product.price!==undefined&&/*#__PURE__*/_jsxs(\"h1\",{className:\"product-price\",children:[parseFloat(product.price).toFixed(2),\" DA\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"icons\",children:[/*#__PURE__*/_jsx(Link,{to:\"/dashboard/products/\".concat(product.id),children:/*#__PURE__*/_jsx(\"i\",{class:\"fa-solid fa-pen-to-square\"})}),/*#__PURE__*/_jsx(Link,{onClick:()=>handleDelete(product.id),children:/*#__PURE__*/_jsx(\"i\",{class:\"fa-solid fa-trash\"})})]})]})]},product.id);})})]});}","map":{"version":3,"names":["useEffect","useState","axios","Link","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ShowProducts","products","setProducts","BASE_URL","nav","fetchProducts","res","get","data","console","log","err","error","handleDelete","id","delete","concat","then","catch","children","className","map","product","_product$images","src","images","length","image","alt","title","description","price","undefined","parseFloat","toFixed","to","class","onClick"],"sources":["C:/Users/painx/Desktop/all-projects/eco-project/frontend/src/pages/Dashboard/Products/ShowProducts.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport \"./DashProducts.css\"; // Add this line\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\n\r\nexport default function ShowProducts() {\r\n    const [products, setProducts] = useState([]);\r\n    const BASE_URL = \"http://127.0.0.1:8000\";\r\n\r\n\r\n    const nav = useNavigate();\r\n\r\n\r\n  // Move fetchProducts outside so we can use it after deletion too\r\n  const fetchProducts = async () => {\r\n    try {\r\n      const res = await axios.get(\"http://127.0.0.1:8000/api/product/show\");\r\n      setProducts(res.data);\r\n      console.log(res.data);\r\n      \r\n      \r\n    } catch (err) {\r\n      console.error(\"Failed to fetch products:\", err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchProducts();\r\n  }, []);\r\n\r\nconsole.log(\"Products:\", products);\r\n\r\n\r\n\r\n\r\nfunction handleDelete(id) {\r\n    axios\r\n      .delete(`http://127.0.0.1:8000/api/product/delete/${id}`)\r\n      .then(() => {\r\n        console.log(\"Deleted product\", id);\r\n        // You can refetch or filter it out from the list\r\n              fetchProducts(); // ⬅️ Call this to refresh the list\r\n      })\r\n      .catch(err => {\r\n        console.error(\"Error deleting product:\", err);\r\n      },[]);\r\n  \r\n}\r\n\r\n\r\n\r\n\r\n\r\n  return (\r\n    <>\r\n      <h1 className=\"page-title\">Products</h1>\r\n      <div className=\"product-grid\">\r\n        {products.map(product => (\r\n          <div className=\"product-card\" key={product.id}>\r\n\r\n<img\r\n  src={\r\n    product.images?.length > 0\r\n      ? BASE_URL + product.images[0]\r\n      : product.image\r\n        ? BASE_URL + product.image\r\n        : \"/default.jpg\" // fallback if no image at all\r\n  }\r\n  alt={product.title}\r\n  className=\"product-image\"\r\n/>\r\n\r\n            <div className=\"product-info\">\r\n              <h2 className=\"product-title\">{product.title}</h2>\r\n              <p className=\"product-desc\">{product.description}</p>\r\n\r\n{product.price !== undefined && (\r\n  <h1 className=\"product-price\">\r\n    {parseFloat(product.price).toFixed(2)} DA\r\n  </h1>\r\n)}\r\n\r\n            <div className=\"icons\">\r\n\r\n\r\n            <Link to={`/dashboard/products/${product.id}`}>\r\n                <i class=\"fa-solid fa-pen-to-square\"></i>\r\n            </Link>\r\n\r\n            <Link onClick={()=> handleDelete(product.id)}>\r\n                <i class=\"fa-solid fa-trash\"></i>\r\n            </Link>\r\n\r\n            </div>\r\n\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}